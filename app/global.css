@import 'tailwindcss';
@custom-variant dark (&:where(.dark, .dark *));

/* Light mode selection */
html:not(.dark) ::selection {
  background-color: #bfdbfe !important;
  color: #1e293b !important;
}

/* Dark mode selection */
html.dark ::selection {
  background-color: #47a3f3;
  color: #fefefe;
}

:root {
  --sh-class: #2d5e9d;
  --sh-identifier: #354150;
  --sh-sign: #8996a3;
  --sh-string: #007f7a;
  --sh-keyword: #e02518;
  --sh-comment: #a19595;
  --sh-jsxliterals: #6266d1;
  --sh-property: #e25a1c;
  --sh-entity: #e25a1c;
}

/* Base page colors */
body {
  @apply text-black bg-[#f5f5f5];
}

/* Global dark mode palette */
html.dark body {
  background-color: #151515; /* neutral dark gray, no blue tint */
  color: #d6d7da; /* softened light gray for lower contrast */
}

/* In light mode, prevent accidental white/very-light text on light backgrounds */
html:not(.dark) .text-white,
html:not(.dark) .text-neutral-50,
html:not(.dark) .text-neutral-100,
html:not(.dark) .text-neutral-200,
html:not(.dark) .dark\:text-neutral-50,
html:not(.dark) .dark\:text-neutral-100,
html:not(.dark) .dark\:text-neutral-200 {
  color: #111827 !important; /* neutral-900-ish */
}

/* Light mode global text safety: force readable text across all pages */
html:not(.dark) body,
html:not(.dark) body :where(*):not(svg):not(path):not(.home-icons):not(.home-icons *):not(.image-overlay-text):not(.image-overlay-text *) {
  color: #111827 !important;
}

/* In dark mode, slightly dim any pure-white utility text so it's not stark */
html.dark .text-white,
html.dark .dark\:text-white,
html.dark .dark\:text-neutral-50,
html.dark .dark\:text-neutral-100 {
  color: #d6d7da !important; /* match softened body text */
}

/* In dark mode, make all text readable by default */
html.dark body * {
  color: inherit;
}

/* In dark mode, strip light highlight backgrounds and use subtle hover for prose content */
html.dark .prose a {
  background-color: transparent !important;
  text-decoration-color: #e5e7eb;
}

html.dark .prose a:hover {
  background-color: rgba(229, 231, 235, 0.18) !important;
  color: #f9fafb;
}

html.dark .prose button:hover {
  background-color: rgba(229, 231, 235, 0.18) !important;
}

/* Override beige backgrounds on home page bio links in dark mode - use gray instead */
html.dark .home-bio a {
  background-color: transparent !important; /* no background by default */
}

html.dark .home-bio a:hover {
  background-color: rgb(82 82 82 / 0.7) !important; /* neutral-600/70 on hover - lighter gray */
}

/* Ensure home page bio links are readable in light mode on all devices */
html:not(.dark) .home-bio a {
  background-color: transparent !important; /* no background by default */
  color: #111827 !important;           /* near-black text */
}

html:not(.dark) .home-bio a:hover {
  background-color: #f2e8da !important; /* beige only on hover */
}

/* Exclude icon links from beige background */
html:not(.dark) .home-icons a {
  background-color: transparent !important;
  color: #d4d4d4 !important; /* neutral-300 - lighter gray */
}

html:not(.dark) .home-icons a svg {
  color: #9a9a9a !important; /* darker gray */
  shape-rendering: geometricPrecision;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* For SVGs that use fill (LinkedIn, GitHub) */
html:not(.dark) .home-icons a svg[fill="currentColor"] * {
  fill: #9a9a9a !important;
  stroke: none !important;
}

/* For SVGs that use stroke (Email, RSS) */
html:not(.dark) .home-icons a svg[stroke="currentColor"] * {
  stroke: #9a9a9a !important;
  fill: none !important;
}

html:not(.dark) .home-icons a:hover {
  color: #111827 !important; /* dark on hover */
}

html:not(.dark) .home-icons a:hover svg {
  color: #111827 !important;
}

html:not(.dark) .home-icons a:hover svg[fill="currentColor"] * {
  fill: #111827 !important;
  stroke: none !important;
}

html:not(.dark) .home-icons a:hover svg[stroke="currentColor"] * {
  stroke: #111827 !important;
  fill: none !important;
}

html:not(.dark) .home-icons a.writing-chip:hover {
  background-color: transparent !important;
}

html.dark .home-icons a {
  background-color: transparent !important;
}

/* Ensure all home page bio text is dark in light mode (iOS sometimes keeps light text) */
html:not(.dark) .home-bio,
html:not(.dark) .home-bio * {
  color: #111827 !important;
}

/* Force dark-mode backgrounds for large cards so light bg doesn't leak through */
html.dark .experience-card,
html.dark .courses-card,
html.dark .teaching-card {
  background-color: #1f1f1f !important; /* slightly lighter than page background for subtle contrast */
  border-color: #4a4a4a !important;     /* more visible neutral gray border, no blue tint */
}

/* Writing page chips (sort controls + read more + list items) */
.writing-chip {
  background-color: transparent;
}

.writing-chip:hover {
  background-color: #f5ecde; /* lighter beige like homepage */
}

html.dark .writing-chip {
  background-color: transparent;
}

html.dark .writing-chip:hover {
  background-color: rgb(64 64 64 / 0.7); /* neutral-700/70 */
}

.writing-chip-active {
  background-color: #f2e8da;
}

.writing-chip-active:hover {
  background-color: #e1d4be;
}

html.dark .writing-chip-active {
  background-color: rgb(64 64 64 / 0.7); /* neutral-700/70 */
}

html.dark .writing-chip-active:hover {
  background-color: rgb(82 82 82); /* neutral-600 */
}

/* Back button hover highlights - exclude nav links */
html:not(.dark) section a[href="/writing"],
html:not(.dark) section a[href="/hobbies"] {
  background-color: transparent !important; /* no background by default in light mode */
}

html:not(.dark) section a[href="/writing"]:hover,
html:not(.dark) section a[href="/hobbies"]:hover {
  background-color: #f2e8da !important; /* beige for light mode - only on hover */
}

html.dark section a[href="/writing"]:hover,
html.dark section a[href="/hobbies"]:hover {
  background-color: rgb(64 64 64 / 0.7) !important; /* gray for dark mode */
}

/* Ensure nav underline is light in dark mode */
html.dark nav a span {
  background-color: rgb(245 245 245) !important; /* neutral-100 - matches text color */
}

/* Pull quote styling inside prose */
.prose blockquote.pull-quote {
  background-color: #e5e7eb !important; /* light gray card in light mode */
  color: #111827 !important;           /* near-black text */
}

html.dark .prose blockquote.pull-quote {
  background-color: #151515 !important; /* neutral dark gray to match page */
  color: #f9fafb !important;            /* near-white text */
  border-color: #4b5563 !important;     /* neutral-600 border */
}

/* Syntax highlighting colors + base color scheme */
html {
  /* Ensure light-mode browser UI on mobile when not in dark mode */
  color-scheme: light;

  --sh-class: #2d5e9d;
  --sh-identifier: #354150;
  --sh-sign: #8996a3;
  --sh-string: #007f7a;
  --sh-keyword: #e02518;
  --sh-comment: #a19595;
  --sh-jsxliterals: #6266d1;
  --sh-property: #e25a1c;
  --sh-entity: #e25a1c;

  min-width: 360px;
}

html.dark {
  --sh-class: #4c97f8;
  --sh-identifier: white;
  --sh-keyword: #f47067;
  --sh-string: #0fa295;
  color-scheme: dark;
}

.prose .anchor {
  @apply absolute invisible no-underline;

  margin-left: -1em;
  padding-right: 0.5em;
  width: 80%;
  max-width: 700px;
  cursor: pointer;
}

.anchor:hover {
  @apply visible;
}

.prose a {
  @apply underline transition-all decoration-neutral-400 dark:decoration-neutral-400 underline-offset-2 decoration-[0.1em];
}

/* Blog post links: beige background by default in light mode (desktop and mobile) */
/* Only apply to blog posts, not hobbies */
html:not(.dark) section:not(.hobbies-page) .prose a {
  background-color: #f2e8da !important; /* light beige default */
}

html:not(.dark) section:not(.hobbies-page) .prose a:hover {
  background-color: #e1d4be !important; /* darker beige on hover */
}

/* Hobbies links: no default background, only on hover in light mode */
html:not(.dark) .hobbies-page .prose a {
  background-color: transparent !important; /* no background by default */
}

html:not(.dark) .hobbies-page .prose a:hover {
  background-color: #f2e8da !important; /* beige only on hover */
}

/* Remove hover highlighting from links inside headings */
html:not(.dark) .hobbies-page .prose h1 a:hover,
html:not(.dark) .hobbies-page .prose h2 a:hover,
html:not(.dark) .hobbies-page .prose h3 a:hover,
html:not(.dark) .hobbies-page .prose h4 a:hover,
html:not(.dark) .hobbies-page .prose h5 a:hover,
html:not(.dark) .hobbies-page .prose h6 a:hover {
  background-color: transparent !important;
}

/* Mobile-specific: same rules apply */
@media (max-width: 767px) {
  html:not(.dark) section:not(.hobbies-page) .prose a {
    background-color: #f2e8da !important; /* light beige default */
  }

  html:not(.dark) section:not(.hobbies-page) .prose a:hover {
    background-color: #e1d4be !important; /* darker beige on hover */
  }

  html:not(.dark) .hobbies-page .prose a {
    background-color: transparent !important; /* no background by default */
  }

  html:not(.dark) .hobbies-page .prose a:hover {
    background-color: #f2e8da !important; /* beige only on hover */
  }

  /* Remove hover highlighting from links inside headings on mobile */
  html:not(.dark) .hobbies-page .prose h1 a:hover,
  html:not(.dark) .hobbies-page .prose h2 a:hover,
  html:not(.dark) .hobbies-page .prose h3 a:hover,
  html:not(.dark) .hobbies-page .prose h4 a:hover,
  html:not(.dark) .hobbies-page .prose h5 a:hover,
  html:not(.dark) .hobbies-page .prose h6 a:hover {
    background-color: transparent !important;
  }
}

.prose .anchor:after {
  @apply text-neutral-300 dark:text-neutral-700;
  content: '#';
}

.prose *:hover > .anchor {
  @apply visible;
}

.prose pre {
  @apply bg-neutral-50 dark:bg-neutral-900 rounded-lg overflow-x-auto border border-neutral-200 dark:border-neutral-900 py-2 px-3 text-sm;
}

.prose code {
  @apply px-1 py-0.5 rounded-lg;
}

.prose pre code {
  @apply p-0;
  border: initial;
  line-height: 1.5;
}

.prose code span {
  @apply font-medium;
}

.prose img {
  /* Don't apply styles to next/image */
  @apply m-0;
}

.prose p {
  @apply my-4 text-neutral-800 dark:text-neutral-200;
}

.prose h1 {
  @apply text-4xl font-medium tracking-tight mt-6 mb-2 text-neutral-900 dark:text-neutral-100;
}

.prose h2 {
  @apply text-xl font-medium tracking-tight mt-6 mb-2 text-neutral-900 dark:text-neutral-100;
}

.prose h3 {
  @apply text-xl font-medium tracking-tight mt-6 mb-2 text-neutral-900 dark:text-neutral-100;
}

.prose h4 {
  @apply text-lg font-medium tracking-tight mt-6 mb-2 text-neutral-900 dark:text-neutral-100;
}

.prose strong {
  @apply font-medium;
}

.prose ul {
  @apply list-disc pl-6;
}

.prose ol {
  @apply list-decimal pl-6;
}

.prose > :first-child {
  /* Override removing top margin, causing layout shift */
  margin-top: 1.25em !important;
  margin-bottom: 1.25em !important;
}

pre::-webkit-scrollbar {
  display: none;
}

pre {
  -ms-overflow-style: none; /* IE and Edge */
  scrollbar-width: none; /* Firefox */
}

/* Remove Safari input shadow on mobile */
input[type='text'],
input[type='email'] {
  -webkit-appearance: none;
  -moz-appearance: none;
  appearance: none;
}

table {
  display: block;
  max-width: fit-content;
  overflow-x: auto;
  white-space: nowrap;
}

.teaching-table {
  width: 100%;
  max-width: 100%;
}

.title {
  text-wrap: balance;
}

/* Smaller text on mobile for blog posts and hobbies */
@media (max-width: 767px) {
  /* Prose content in blog posts and hobbies - reduce base font size */
  .prose {
    font-size: 16px !important;
  }
  
  .prose p,
  .prose li,
  .prose td,
  .prose th {
    font-size: 16px !important;
  }
  
  /* Reduce heading sizes proportionally on mobile */
  .prose h1 {
    font-size: 1.875rem !important; /* 30px instead of default */
  }
  
  .prose h2,
  .prose h3 {
    font-size: 1.25rem !important; /* 20px */
  }
  
  .prose h4 {
    font-size: 1.125rem !important; /* 18px */
  }
}

/* Footer date link hover in dark mode */
html.dark .footer-date-link:hover {
  background-color: rgb(64 64 64 / 0.7) !important; /* neutral-700/70 */
}

/* Materials link in courses page - dark mode background only on hover */
html.dark .materials-link {
  background-color: transparent !important; /* no background by default */
}

html.dark .materials-link:hover {
  background-color: rgb(64 64 64 / 0.7) !important; /* neutral-700/70 on hover */
}

/* All links in courses page - ensure dark mode uses gray highlights, not beige */
html.dark section a[href^="https://drive.google.com"],
html.dark .courses-card a {
  background-color: transparent !important; /* no background by default */
}

html.dark section a[href^="https://drive.google.com"]:hover,
html.dark .courses-card a:hover {
  background-color: rgb(64 64 64 / 0.7) !important; /* neutral-700/70 on hover - gray, not beige */
}

/* Theme toggle button - ensure consistent styling on mobile and desktop */
button[aria-label="Toggle theme"] {
  background-color: #e5e7eb !important; /* neutral-200 */
  border-color: #737373 !important; /* neutral-500 */
}

button[aria-label="Toggle theme"]:hover {
  background-color: #d4d4d4 !important; /* neutral-300 */
}

html.dark button[aria-label="Toggle theme"] {
  background-color: #151515 !important;
  border-color: #404040 !important;
}

html.dark button[aria-label="Toggle theme"]:hover {
  background-color: #1a1a1a !important;
}

html.dark button[aria-label="Toggle theme"] span {
  background-color: #525252 !important; /* neutral-600 */
}

/* Larger footer icons on mobile */
@media (max-width: 767px) {
  .home-icons svg {
    width: 20px !important;
    height: 20px !important;
  }
}

/* Homepage fade-in entrance animation */
@keyframes fade-in {
  from {
    opacity: 0;
    transform: translateY(14px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-in-up {
  animation: fade-in 0.8s ease-out 0.15s both;
}

/* Image overlay text - force white text in light mode */
html:not(.dark) .image-overlay-text,
html:not(.dark) .image-overlay-text * {
  color: #ffffff !important;
}
